CHANNELS = {
    "gear": {
        "datatype": 3,
        "datasize": 2,
        "name": "Gear",
        "shortname": "Gear",
        "units": ""
    },
    "throttle": {
        "datatype": 3,
        "datasize": 2,
        "name": "Throttle Pos",
        "shortname": "Thr Pos",
        "units": "%"
    },
    "brake": {
        "datatype": 3,
        "datasize": 2,
        "name": "Brake Pos",
        "shortname": "Brk Pos",
        "units": "%"
    },
    "clutch": {
        "datatype": 3,
        "datasize": 2,
        "name": "Clutch Pos",
        "shortname": "ClutchPos",
        "units": "%"
    },
    "steer": {
        "datatype": 3,
        "datasize": 2,
        "decplaces": 2,
        "name": "Steering Pos",
        "shortname": "SteerPos",
        "units": "%"
    },
    "speed": {
        "datatype": 3,
        "datasize": 2,
        "name": "Ground Speed",
        "shortname": "Gnd Spd",
        "units": [ "kph", "mph" ]
    },
    "lat": {
        "decplaces": 7,
        "name": "GPS Latitude",
        "shortname": "GPSLat",
        "units": "deg"
    },
    "long": {
        "decplaces": 7,
        "name": "GPS Longitude",
        "shortname": "GPSLong",
        "units": "deg"
    },
    "beacon": {
        "datatype": 0,
        "datasize": 2,
        "name": "Beacon",
        "shortname": "Beacon",
        "units": ""
    },
    "br2": {
        "datatype": 3,
        "datasize": 2,
        "name": "BR2 Beacon Number",
        "shortname": "BR2 Num",
        "units": ""
    },
    "lap": {
        "datatype": 3,
        "datasize": 2,
        "name": "Lap Number",
        "shortname": "Lap",
        "units": ""
    },
    "rpm": {
        "datatype": 3,
        "datasize": 2,
        "name": "Engine RPM",
        "shortname": "RPM",
        "units": "rpm"
    },
    "velx": {
        "decplaces": 3,
        "name": "Velocity X",
        "shortname": "VELX",
        "units": "m/s"
    },
    "vely": {
        "decplaces": 3,
        "name": "Velocity Y",
        "shortname": "VELY",
        "units": "m/s"
    },
    "velz": {
        "decplaces": 3,
        "name": "Velocity Z",
        "shortname": "VELZ",
        "units": "m/s"
    },
    "angvelx": {
        "decplaces": 3,
        "name": "Angular Velocity X",
        "shortname": "ANGVELX",
        "units": "rad/s"
    },
    "angvely": {
        "decplaces": 3,
        "name": "Angular Velocity Y",
        "shortname": "ANGVELY",
        "units": "rad/s"
    },
    "angvelz": {
        "decplaces": 3,
        "name": "Angular Velocity Z",
        "shortname": "ANGVELZ",
        "units": "rad/s"
    },
    "orientationx": {
        "decplaces": 3,
        "name": "Orientation X",
        "shortname": "ORIX",
        "units": "deg"
    },
    "orientationy": {
        "decplaces": 3,
        "name": "Orientation Y",
        "shortname": "ORIY",
        "units": "deg"
    },
    "orientationz": {
        "decplaces": 3,
        "name": "Orientation Z",
        "shortname": "ORIZ",
        "units": "deg"
    },
    "posx": {
        "decplaces": 3,
        "name": "Position X",
        "shortname": "POSX",
        "units": "m"
    },
    "posy": {
        "decplaces": 3,
        "name": "Position Y",
        "shortname": "POSY",
        "units": "m"
    },
    "posz": {
        "decplaces": 3,
        "name": "Position Z",
        "shortname": "POSZ",
        "units": "m"
    },
    "glat": {
        "decplaces": 2,
        "name": "G Force Lat",
        "shortname": "G Lat",
        "units": "G"
    },
    "gvert": {
        "decplaces": 2,
        "name": "G Force Vert",
        "shortname": "G Vert",
        "units": "G"
    },
    "glong": {
        "decplaces": 2,
        "name": "G Force Long",
        "shortname": "G Long",
        "units": "G"
    },
    "wspdfl": {
        "decplaces": 1,
        "name": "Wheel Speed FL",
        "shortname": "WSpd FL",
        "units": [ "kph", "mph" ]
    },
    "wspdfr": {
        "decplaces": 1,
        "name": "Wheel Speed FR",
        "shortname": "WSpd FR",
        "units": [ "kph", "mph" ]
    },
    "wspdrl": {
        "decplaces": 1,
        "name": "Wheel Speed RL",
        "shortname": "WSpd RL",
        "units": [ "kph", "mph" ]
    },
    "wspdrr": {
        "decplaces": 1,
        "name": "Wheel Speed RR",
        "shortname": "WSpd RR",
        "units": [ "kph", "mph" ]
    },
    "tyreyfl": {
        "decplaces": 3,
        "name": "Tyre Y FL",
        "shortname": "TYREYFL",
        "units": "m"
    },
    "tyreyfr": {
        "decplaces": 3,
        "name": "Tyre Y FR",
        "shortname": "TYREYFR",
        "units": "m"
    },
    "tyreyrl": {
        "decplaces": 3,
        "name": "Tyre Y RL",
        "shortname": "TYREYRL",
        "units": "m"
    },
    "tyreyrr": {
        "decplaces": 3,
        "name": "Tyre Y RR",
        "shortname": "TYREYRR",
        "units": "m"
    },
    "suspfl": {
        "decplaces": 3,
        "name": "Susp Pos FL",
        "shortname": "SuspFL",
        "units": "cm"
    },
    "suspfr": {
        "decplaces": 3,
        "name": "Susp Pos FR",
        "shortname": "SuspFR",
        "units": "cm"
    },
    "susprl": {
        "decplaces": 3,
        "name": "Susp Pos RL",
        "shortname": "SuspRL",
        "units": "cm"
    },
    "susprr": {
        "decplaces": 3,
        "name": "Susp Pos RR",
        "shortname": "SuspRR",
        "units": "cm"
    },
    "suspvelfl": {
        "decplaces": 3,
        "name": "Susp Vel FL",
        "shortname": "SuspVFL",
        "units": "m/s"
    },
    "suspvelfr": {
        "decplaces": 3,
        "name": "Susp Vel FR",
        "shortname": "SuspVFR",
        "units": "m/s"
    },
    "suspvelrl": {
        "decplaces": 3,
        "name": "Susp Vel RL",
        "shortname": "SuspVRL",
        "units": "m/s"
    },
    "suspvelrr": {
        "decplaces": 3,
        "name": "Susp Vel RR",
        "shortname": "SuspVRR",
        "units": "m/s"
    },
    "tyretempfl": {
        "decplaces": 2,
        "name": "Tyre Temp FL",
        "shortname": "TTempFL",
        "units": "C"
    },
    "tyretempfr": {
        "decplaces": 2,
        "name": "Tyre Temp FR",
        "shortname": "TTempFR",
        "units": "C"
    },
    "tyretemprl": {
        "decplaces": 2,
        "name": "Tyre Temp RL",
        "shortname": "TTempRL",
        "units": "C"
    },
    "tyretemprr": {
        "decplaces": 2,
        "name": "Tyre Temp RR",
        "shortname": "TTempRR",
        "units": "C"
    },
    "tyrepresfl": {
        "decplaces": 2,
        "name": "Tyre Pressure FL",
        "shortname": "TPresFL",
        "units": "kPa"
    },
    "tyrepresfr": {
        "decplaces": 2,
        "name": "Tyre Pressure FR",
        "shortname": "TPresFR",
        "units": "kPa"
    },
    "tyrepresrl": {
        "decplaces": 2,
        "name": "Tyre Pressure RL",
        "shortname": "TPresRL",
        "units": "kPa"
    },
    "tyrepresrr": {
        "decplaces": 2,
        "name": "Tyre Pressure RR",
        "shortname": "TPresRR",
        "units": "kPa"
    },
    "braketempfl": {
        "decplaces": 2,
        "name": "Brake Temp FL",
        "shortname": "BTempFL",
        "units": "C"
    },
    "braketempfr": {
        "decplaces": 2,
        "name": "Brake Temp FR",
        "shortname": "BTempFR",
        "units": "C"
    },
    "braketemprl": {
        "decplaces": 2,
        "name": "Brake Temp RL",
        "shortname": "BTempRL",
        "units": "C"
    },
    "braketemprr": {
        "decplaces": 2,
        "name": "Brake Temp RR",
        "shortname": "BTempRR",
        "units": "C"
    },
    "lap": {
        "datatype": 3,
        "datasize": 2,
        "name": "Lap Number",
        "shortname": "Lap",
    },
    "laptime": {
        "decplaces": 3,
        "name": "Lap Time",
        "shortname": "LapTime",
        "units": "s"
    },
    "racestate": {
        "datatype": 3,
        "datasize": 2,
        "name": "Race Status",
        "shortname": "RState",
    },
    "tyretempflo": {
        "decplaces": 2,
        "name": "Tyre Temp FL Outer",
        "shortname": "TTempFLO",
        "units": "C"
    },
    "tyretempfro": {
        "decplaces": 2,
        "name": "Tyre Temp FR Outer",
        "shortname": "TTempFRO",
        "units": "C"
    },
    "tyretempflc": {
        "decplaces": 2,
        "name": "Tyre Temp FL Centre",
        "shortname": "TTempFLC",
        "units": "C"
    },
    "tyretempfrc": {
        "decplaces": 2,
        "name": "Tyre Temp FR Centre",
        "shortname": "TTempFRC",
        "units": "C"
    },
    "tyretempfli": {
        "decplaces": 2,
        "name": "Tyre Temp FL Inner",
        "shortname": "TTempFLI",
        "units": "C"
    },
    "tyretempfri": {
        "decplaces": 2,
        "name": "Tyre Temp FR Inner",
        "shortname": "TTempFRI",
        "units": "C"
    },
    "tyretemprlo": {
        "decplaces": 2,
        "name": "Tyre Temp RL Outer",
        "shortname": "TTempRLO",
        "units": "C"
    },
    "tyretemprro": {
        "decplaces": 2,
        "name": "Tyre Temp RR Outer",
        "shortname": "TTempRRO",
        "units": "C"
    },
    "tyretemprlc": {
        "decplaces": 2,
        "name": "Tyre Temp RL Centre",
        "shortname": "TTempRLC",
        "units": "C"
    },
    "tyretemprrc": {
        "decplaces": 2,
        "name": "Tyre Temp RR Centre",
        "shortname": "TTempRRC",
        "units": "C"
    },
    "tyretemprli": {
        "decplaces": 2,
        "name": "Tyre Temp RL Inner",
        "shortname": "TTempRLI",
        "units": "C"
    },
    "tyretemprri": {
        "decplaces": 2,
        "name": "Tyre Temp RR Inner",
        "shortname": "TTempRRI",
        "units": "C"
    },
    "tyrespdfl": {
        "decplaces": 2,
        "name": "Tyre Speed FL",
        "shortname": "TyreSPDFL",
        "units": "rad/s"
    },
    "tyrespdfr": {
        "decplaces": 2,
        "name": "Tyre Speed FR",
        "shortname": "TyreSPDFR",
        "units": "rad/s"
    },
    "tyrespdrl": {
        "decplaces": 2,
        "name": "Tyre Speed RL",
        "shortname": "TyreSPDRL",
        "units": "rad/s"
    },
    "tyrespdrr": {
        "decplaces": 2,
        "name": "Tyre Speed RR",
        "shortname": "TyreSPDRR",
        "units": "rad/s"
    },
    "wheelslipfl": {
        "decplaces": 1,
        "name": "Wheel Slip FL",
        "shortname": "WSLPFL",
        "units": [ "kph", "mph" ]
    },
    "wheelslipfr": {
        "decplaces": 1,
        "name": "Wheel Slip FR",
        "shortname": "WSLPFR",
        "units": [ "kph", "mph" ]
    },
    "wheelsliprl": {
        "decplaces": 1,
        "name": "Wheel Slip RL",
        "shortname": "WSLPRL",
        "units": [ "kph", "mph" ]
    },
    "wheelsliprr": {
        "decplaces": 1,
        "name": "Wheel Slip RR",
        "shortname": "WSLPRR",
        "units": [ "kph", "mph" ]
    },
    "frontwing": {
        "decplaces": 2,
        "name": "Front Wing",
        "shortname": "FWING",
    },
    "rearwing": {
        "decplaces": 2,
        "name": "Rear Wing",
        "shortname": "RWING",
    },
    "rideheightfl": {
        "decplaces": 2,
        "name": "Ride Height FL",
        "shortname": "RHeightFL",
        "units": "cm"
    },
    "rideheightfr": {
        "decplaces": 2,
        "name": "Ride Height FR",
        "shortname": "RHeightFR",
        "units": "cm"
    },
    "rideheightrl": {
        "decplaces": 2,
        "name": "Ride Height RL",
        "shortname": "RHeightRL",
        "units": "cm"
    },
    "rideheightrr": {
        "decplaces": 2,
        "name": "Ride Height RR",
        "shortname": "RHeightRR",
        "units": "cm"
    },
    "rideheight": {
        "decplaces": 2,
        "name": "Ride Height",
        "shortname": "RHeight",
        "units": "cm"
    },
    "turbopres": {
        "decplaces": 2,
        "name": "Turbo Boost Pressure",
        "shortname": "TurboP",
        "units": "kPa"
    },    
    "brakebias": {
        "decplaces": 2,
        "name": "Brake Bias Setting",
        "shortname": "BrakeBias",
        "units": "%"
    },    
    "enginetorque": {
        "decplaces": 2,
        "name": "Engine Torque",
        "shortname": "ETorque",
        "units": "Nm"
    },
    "oiltemp": {
        "decplaces": 2,
        "name": "Eng Oil Temp",
        "shortname": "OilTemp",
        "units": "C"
    },
    "oilpres": {
        "decplaces": 2,
        "name": "Eng Oil Pres",
        "shortname": "OilPres",
        "units": "kPa"
    },
    "watertemp": {
        "decplaces": 2,
        "name": "Eng Water Temp",
        "shortname": "WaterTemp",
        "units": "C"
    },
    "waterpres": {
        "decplaces": 2,
        "name": "Eng Water Pres",
        "shortname": "WaterPres",
        "units": "kPa"
    },
    "fuelpres": {
        "decplaces": 2,
        "name": "Fuel Pres",
        "shortname": "FuelPres",
        "units": "kPa"
    },
    "fuellevel": {
        "decplaces": 2,
        "name": "Fuel Level",
        "shortname": "FuelLevel",
        "units": "l"
    },
    "fuelcapacity": {
        "decplaces": 2,
        "name": "Fuel Capacity",
        "shortname": "FuelCapacity",
        "units": "l"
    },
    "abs": {
        "datatype": 0,
        "datasize": 2,
        "name": "ABS Active",
        "shortname": "ABSActive"
    },
    "tcs": {
        "datatype": 0,
        "datasize": 2,
        "name": "TCS Active",
        "shortname": "TCSActive"
    },
    "asm": {
        "datatype": 0,
        "datasize": 2,
        "name": "ASM Active",
        "shortname": "ASMActive"
    },
    "splittime": {
        "decplaces": 3,
        "name": "Split Time",
        "shortname": "SplitTime",
        "units": "s"
    },
    "ers": {
        "datatype": 0,
        "datasize": 2,
        "name": "ERS Active",
        "shortname": "ERSActive"
    },
    "drs": {
        "datatype": 0,
        "datasize": 2,
        "name": "DRS Active",
        "shortname": "DRSActive"
    },
    "drsavail": {
        "datatype": 0,
        "datasize": 2,
        "name": "DRS Available",
        "shortname": "DRSAvail"
    },
    "boost": {
        "datatype": 0,
        "datasize": 2,
        "name": "Boost Active",
        "shortname": "BoostActive"
    },
    "boostavail": {
        "decplaces": 2,
        "name": "Boost Available",
        "shortname": "BoostAvail",
        "units": "%"
    },
    "ambienttemp": {
        "decplaces": 2,
        "name": "Ambient Temp",
        "shortname": "AmbTemp",
        "units": "C"
    },
    "tracktemp": {
        "decplaces": 2,
        "name": "Track Temp",
        "shortname": "TrackTemp",
        "units": "C"
    },
    "debug1": {
        "decplaces": 2,
        "name": "Debug 1",
        "shortname": "Debug1",
    },
    "debug2": {
        "decplaces": 2,
        "name": "Debug 2",
        "shortname": "Debug2",
    }
}

START_ID = 8000

for (i, v) in enumerate(CHANNELS.values()):
    if "id" not in v:
        v["id"] = START_ID + i

def get_channel_definition(name, freq=None, imperial=False):

    if freq is None:
        freq = 20

    # get some defaults
    cd = {
        "datatype": 5,
        "datasize": 4,
        "freq": freq,
        "shift": 0,
        "multiplier": 1,
        "scale": 1,
        "decplaces": 0,
        "units": ""
    }

    # see if we are overriding the channel specifically from the logger
    if isinstance(name, dict):
        td = dict(name)
        name = td["name"]
        del td["name"]
        cd.update(dict(CHANNELS[name]))
        cd.update(td)
    else:
        cd.update(dict(CHANNELS[name]))
    
    # check the units
    if isinstance(cd["units"], list):
        cd["units"] = cd["units"][ 1 if imperial else 0 ]

    return cd